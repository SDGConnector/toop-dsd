dist: xenial
sudo: required
language: java

env:
  global:
    - SONATYPE_USERNAME=ph@phloc.com
    - secure: "AVTpN0z7RyG3CTn46nNBLHptkB11i75creWd8hPLgAXDZZHEwyloR0z2UoJaOBiegksKwdgchq11aCyGebLVA0R8T6EwRQt41eoAKHfcjMVtlfCgl/Jkpdp7+OJn+cj
fbBcWiUlXdeIf66ynkcBAx96Elxv3D+hV8sqxN2e6VeLTw9F6mj3PMk5gZlA+K57SKCxfw1RSreMF11RPCZtV+ol0vAUhNEbMaYFJ3w1322RX/yr0xbhgIJkJsUzQ2V5KZNRZuJYl4
ly6mVcZK8y88eX4JMFTHiIglZ+jq9Lyt7xmmkR7ghprPSFgblm9Z/A8wTXmUva8m3SRFpEaYVfdreJqKOyDBSERI5l/7ZoJD5Q/5k1LZnC1uF1wkAdIt54hBMjdTACW8pw34Lv9wEa
uUO3pTt1SKybxQI1+rvxYRCvLClb1u6FMBDEkQHcn+aNGl0nKUTArmg4p60MKvW1GCge+IYvLj/Fpgvmc3rFkgMwQPeyAYeQdpghh7VNVUNTFyv+ov8HydRZzFRcLkCZtg1eTNaJtR
QHgHvtBbGQdRmmZHtAPK0o9Z25s76rXOkRd+B1iZEurOsvQIT8hsGRjhZL682cNHm4Jwe7R3qf2a0wyW/wGpXxUNFPOf1IW1xnAxE+RVO98g4IpbYkZD5e9bYdXhQmq6SDPH/a7jjo
X5Nw="

install:
#  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V -U -P jdeps
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V -U

cache:
  directories:
    - $HOME/.m2

branches:
  only:
    - master

jobs:
  include:
    - stage: test
      jdk: openjdk8
      script:
        - mvn test -B -P coverage
      after_success:
        - mvn deploy --settings travis-settings.xml -DskipTests=true -B -P travis-deploy
        - bash <(curl -s https://codecov.io/bash)
    - stage: test
      jdk: openjdk11
      script:
        - mvn test -B
    - stage: test
      jdk: openjdk14
      script:
        - mvn test -B
